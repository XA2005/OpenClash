import{u as ne,d as e,ao as Ne,i as t,ac as T,ap as Ie,aq as De,D as x,ar as Me,as as ke,at as Oe,F as U,au as Ae,av as Be,aw as Fe,ax as Re,ay as z,az as Ue,aA as He,g as v,aB as je,aC as Ye,aD as ze,aE as Qe,aF as le,aG as we,aH as ae,aI as ee,aJ as Ce,aK as Pe,Q as Ke,t as h,aL as We,aM as he,S as F,aN as I,aO as Se,aP as de,a0 as R,$ as te,aa as Te,H as ce,E as Xe,W as qe,b as Je,y as Ve,R as Ze,T as Ge,A as me,o as et,B as V,a3 as tt,aQ as nt,aR as be,aS as pe,aT as fe,aU as xe,m as rt}from"./index-B2UtOO5P.js";import{f as it}from"./global-B38ASNh1.js";import{D as st}from"./DocumentTitle-CREjclRv.js";import{I as $e}from"./IconReload-BbW1-cC8.js";var lt=h('<div class="flex flex-col gap-4"><div><div class="flex w-full justify-center"><input class=toggle type=checkbox></div></div><div class="flex flex-col"><input class="input input-bordered w-full"></div><div><input type=number class="input input-bordered w-full"></div><div class="flex flex-col"><input class="input input-bordered w-full"></div><div><select class="select select-bordered w-full"></select></div><div><div class="flex w-full justify-center"><input class=toggle type=checkbox></div></div><div><div class="flex w-full justify-center"><input class=toggle type=checkbox></div></div><div><select class="select select-bordered w-full"></select></div><div><input type=number class="input input-bordered w-full"><input type=number class="input input-bordered w-full">'),at=h('<option class="flex items-center gap-2">'),ct=h("<option>");const dt=s=>{const[r]=ne();return e(Ke,{ref:n=>{var l;return(l=s.ref)==null?void 0:l.call(s,n)},get icon(){return e(Ne,{size:24})},get title(){return r("proxiesSettings")},get children(){var n=lt(),l=n.firstChild,d=l.firstChild,u=d.firstChild,p=l.nextSibling,L=p.firstChild,o=p.nextSibling,D=o.firstChild,$=o.nextSibling,C=$.firstChild,P=$.nextSibling,S=P.firstChild,m=P.nextSibling,E=m.firstChild,M=E.firstChild,y=m.nextSibling,k=y.firstChild,Q=k.firstChild,K=y.nextSibling,j=K.firstChild,W=K.nextSibling,Y=W.firstChild,O=Y.nextSibling;return t(l,e(T,{withDivider:!0,get children(){return r("autoCloseConns")}}),d),u.addEventListener("change",a=>Ie(a.target.checked)),t(p,e(T,{withDivider:!0,get children(){return r("urlForLatencyTest")}}),L),L.addEventListener("change",a=>De(a.target.value)),t(o,e(T,{withDivider:!0,get children(){return[x(()=>r("latencyTestTimeoutDuration"))," (",x(()=>r("ms")),")"]}}),D),D.addEventListener("change",a=>Me(Number(a.target.value))),t($,e(T,{withDivider:!0,get children(){return r("urlForIPv6SupportTest")}}),C),C.addEventListener("change",a=>{var _;return ke((_=a.target.value)==null?void 0:_.trim())}),t(P,e(T,{withDivider:!0,get children(){return r("proxiesSorting")}}),S),S.addEventListener("change",a=>Oe(a.target.value)),t(S,e(U,{get each(){return Object.values(Ae)},children:a=>(()=>{var _=at();return _.value=a,t(_,()=>r(a)),_})()})),t(m,e(T,{withDivider:!0,get children(){return r("hideUnavailableProxies")}}),E),M.addEventListener("change",a=>Be(a.target.checked)),t(y,e(T,{withDivider:!0,get children(){return r("renderInTwoColumns")}}),k),Q.addEventListener("change",a=>Fe(a.target.checked)),t(K,e(T,{withDivider:!0,get children(){return r("proxiesPreviewType")}}),j),j.addEventListener("change",a=>Re(a.target.value)),t(j,e(U,{get each(){return Object.values(z)},children:a=>(()=>{var _=ct();return _.value=a,t(_,()=>r(a)),_})()})),t(W,e(T,{withDivider:!0,get children(){return r("iconHeight")}}),Y),Y.addEventListener("change",a=>Ue(Number(a.target.value))),t(W,e(T,{withDivider:!0,get children(){return r("iconMarginRight")}}),O),O.addEventListener("change",a=>He(Number(a.target.value))),v(()=>u.checked=je()),v(()=>L.value=Ye()),v(()=>D.value=ze()),v(()=>C.value=Qe()),v(()=>S.value=le()),v(()=>M.checked=we()),v(()=>Q.checked=ae()),v(()=>j.value=ee()),v(()=>Y.value=Ce()),v(()=>O.value=Pe()),n}})},ye=s=>{const r=()=>ee()===z.OFF,n=x(()=>s.proxyNameList.length<=10),l=x(()=>{const u=ee();return u===z.BAR||u===z.Auto&&!n()}),d=x(()=>{const u=ee();return u===z.DOTS||u===z.Auto&&n()});return e(F,{get when(){return!r()},get children(){return e(We,{get children(){return[e(he,{get when(){return l()},get children(){return e(ut,{get proxyNameList(){return s.proxyNameList},get now(){return s.now}})}}),e(he,{get when(){return d()},get children(){return e(mt,{get proxyNameList(){return s.proxyNameList},get now(){return s.now}})}})]}})}})};var ot=h('<div class="flex items-center gap-2 py-2"><div class="my-1 flex flex-1 items-center justify-center overflow-hidden rounded-2xl [&amp;>*]:h-2"><div class=bg-success></div><div class=bg-warning></div><div class=bg-error></div><div class=bg-neutral>');const ut=s=>{const{getLatencyByName:r}=de(),n=x(()=>s.proxyNameList.map(o=>r(o))),l=x(()=>n().length),d=x(()=>n().filter(o=>o>I().NOT_CONNECTED&&o<=I().MEDIUM).length),u=x(()=>n().filter(o=>o>I().MEDIUM&&o<=I().HIGH).length),p=x(()=>n().filter(o=>o>I().HIGH).length),L=x(()=>n().filter(o=>o===I().NOT_CONNECTED).length);return(()=>{var o=ot(),D=o.firstChild,$=D.firstChild,C=$.nextSibling,P=C.nextSibling,S=P.nextSibling;return t(o,e(Se,{get name(){return s.now}}),null),v(m=>{var E=`${d()*100/l()}%`,M=`${u()*100/l()}%`,y=`${p()*100/l()}%`,k=`${L()*100/l()}%`;return E!==m.e&&((m.e=E)!=null?$.style.setProperty("width",E):$.style.removeProperty("width")),M!==m.t&&((m.t=M)!=null?C.style.setProperty("width",M):C.style.removeProperty("width")),y!==m.a&&((m.a=y)!=null?P.style.setProperty("width",y):P.style.removeProperty("width")),k!==m.o&&((m.o=k)!=null?S.style.setProperty("width",k):S.style.removeProperty("width")),m},{e:void 0,t:void 0,a:void 0,o:void 0}),o})()};var gt=h("<div>"),vt=h('<div class="flex items-center gap-2 py-2"><div class="flex flex-1 flex-wrap items-center gap-1">');const ht=s=>{let r=s.selected?"bg-white border-4 border-success":"bg-success";return typeof s.latency!="number"||s.latency===I().NOT_CONNECTED?r=s.selected?"bg-white border-4 border-neutral":"bg-neutral":s.latency>I().HIGH?r=s.selected?"bg-white border-4 border-error":"bg-error":s.latency>I().MEDIUM&&(r=s.selected?"bg-white border-4 border-warning":"bg-warning"),(()=>{var n=gt();return v(l=>{var d=R("h-4 w-4 rounded-full",r),u=s.name;return d!==l.e&&te(n,l.e=d),u!==l.t&&Te(n,"title",l.t=u),l},{e:void 0,t:void 0}),n})()},mt=s=>{const{getLatencyByName:r}=de();return(()=>{var n=vt(),l=n.firstChild;return t(l,e(U,{get each(){return s.proxyNameList.map(d=>[d,r(d)])},children:([d,u])=>{const p=s.now===d;return e(ht,{name:d,latency:u,selected:p})}})),t(n,e(Se,{get name(){return s.now}}),null),n})()};var bt=h("<progress class=progress max=100>"),pt=h('<div class="text-sm text-slate-500"> / <!> ( <!>% )'),ft=h('<div class="text-sm text-slate-500">: ');const xt=s=>{const{Download:r=0,Upload:n=0,Total:l=0,Expire:d=0}=s,u=ce(l,{units:"iec"}),p=ce(r+n,{units:"iec"}),L=Xe.toFinite(((r+n)/l*100).toFixed(2));return{total:u,used:p,percentage:L,expirePrefix:()=>{const[$]=ne();return $("expire")},expireStr:()=>{const[$]=ne();return d===0?$("noExpire"):qe(d*1e3).format("YYYY-MM-DD")}}},$t=s=>{if(!s.subscriptionInfo)return;const r=xt(s.subscriptionInfo);return[(()=>{var n=bt();return v(()=>n.value=r.percentage),n})(),(()=>{var n=pt(),l=n.firstChild,d=l.nextSibling,u=d.nextSibling,p=u.nextSibling;return p.nextSibling,t(n,()=>`${r.used}`,l),t(n,()=>`${r.total}`,d),t(n,()=>r.percentage,p),n})(),(()=>{var n=ft(),l=n.firstChild;return t(n,()=>r.expirePrefix(),l),t(n,()=>r.expireStr(),null),n})()]};var _e=h("<div>"),yt=h('<div class="flex h-full flex-col gap-2"><div class="flex items-center gap-2"><div class="tabs-boxed tabs gap-2"></div><div class=ml-auto></div></div><div class="flex-1 overflow-y-auto">'),_t=h('<button><span></span><div class="badge badge-sm">'),wt=h("<img>"),Ct=h("<span class=whitespace-nowrap>&nbsp;::&nbsp;"),Pt=h('<div class=space-y-2><div class="flex items-center justify-between pr-8"><div class="flex items-center"><span></span><div class="badge badge-sm ml-2"></div></div></div><div class="flex flex-wrap items-center justify-between gap-2"><div class="badge badge-primary badge-sm"><span class=font-bold></span></div><div class="badge badge-secondary badge-sm">/s'),St=h('<div class="flex items-center justify-between pr-8"><div class="flex items-center gap-2"><span></span><div class="badge badge-sm"></div></div><div class="flex items-center gap-2">'),Tt=h('<div class="text-sm text-slate-500"> :: <!> ');const Dt=()=>{const s=Je();if(!Ve())return s("/setup",{replace:!0}),null;let r;const[n]=ne(),{fetchProxies:l,proxies:d,selectProxyInGroup:u,proxyProviders:p,updateProviderByProviderName:L,updateAllProvider:o,proxyGroupLatencyTest:D,proxyProviderLatencyTest:$,proxyGroupLatencyTestingMap:C,proxyProviderLatencyTestingMap:P,isAllProviderUpdating:S,updatingMap:m}=de(),E=x(()=>d().filter(f=>!f.hidden)),{speedGroupByName:M}=Ze(),[y,k]=Ge(me({}),{name:"collapsedMap",storage:localStorage}),Q=(f,w)=>{k(Z=>({...Z,[f]:w}))};et(l);const K=async(f,w)=>{f.stopPropagation(),D(w)},j=(f,w)=>{f.stopPropagation(),$(w)},W=(f,w)=>{f.stopPropagation(),L(w)},Y=async f=>{f.stopPropagation(),o()},[O,a]=me("proxies"),_=()=>[{type:"proxies",name:n("proxies"),count:E().length},{type:"proxyProviders",name:n("proxyProviders"),count:p().length}];return[e(st,{get children(){return n("proxies")}}),(()=>{var f=yt(),w=f.firstChild,Z=w.firstChild,oe=Z.nextSibling,ue=w.nextSibling;return t(Z,e(U,{get each(){return _()},children:b=>(()=>{var i=_t(),A=i.firstChild,X=A.nextSibling;return i.$$click=()=>a(b.type),t(A,()=>b.name),t(X,()=>b.count),v(()=>te(i,R(O()===b.type&&"tab-active","tab-sm sm:tab-md tab gap-2 px-2"))),i})()})),t(w,e(F,{get when(){return O()==="proxyProviders"},get children(){return e(V,{class:"btn btn-circle btn-sm",get disabled(){return S()},onClick:b=>Y(b),get icon(){return e($e,{get class(){return R(S()&&"animate-spin text-success")}})}})}}),oe),t(oe,e(V,{class:"btn-circle btn-primary btn-sm",onClick:()=>r==null?void 0:r.showModal(),get icon(){return e(tt,{})}})),t(ue,e(F,{get when(){return O()==="proxies"},get children(){var b=_e();return t(b,e(U,{get each(){return E()},children:i=>{const A=x(()=>nt(be(i.all??[],le()),we())),X=(()=>{var c=Pt(),N=c.firstChild,B=N.firstChild,q=B.firstChild,G=q.nextSibling,J=N.nextSibling,re=J.firstChild,Le=re.firstChild,ge=re.nextSibling,Ee=ge.firstChild;return t(B,e(F,{get when(){return i.icon},get children(){var g=wt();return v(H=>{var ve=i.icon,ie=`${Ce()}px`,se=`${Pe()}px`;return ve!==H.e&&Te(g,"src",H.e=ve),ie!==H.t&&((H.t=ie)!=null?g.style.setProperty("height",ie):g.style.removeProperty("height")),se!==H.a&&((H.a=se)!=null?g.style.setProperty("margin-right",se):g.style.removeProperty("margin-right")),H},{e:void 0,t:void 0,a:void 0}),g}}),q),t(q,()=>i.name),t(G,()=>{var g;return(g=i.all)==null?void 0:g.length}),t(N,e(V,{class:"btn-circle btn-sm",get disabled(){return C()[i.name]},onClick:g=>K(g,i.name),get icon(){return e(pe,{get class(){return R(C()[i.name]&&"animate-pulse text-success")}})}}),null),t(Le,()=>i.type),t(re,e(F,{get when(){var g;return((g=i.now)==null?void 0:g.length)>0},get children(){var g=Ct();return g.firstChild,t(g,()=>i.now,null),g}}),null),t(ge,()=>ce(M()[i.name]??0).toString(),Ee),t(c,e(F,{get when(){return!y()[i.name]},get children(){return e(ye,{get proxyNameList(){return A()},get now(){return i.now}})}}),null),c})();return e(fe,{get isOpen(){return y()[i.name]},title:X,onCollapse:c=>Q(i.name,c),get children(){return e(U,{get each(){return A()},children:c=>e(xe,{proxyName:c,get isSelected(){return i.now===c},onClick:()=>void u(i,c)})})}})}})),v(()=>te(b,R("grid grid-cols-1 place-items-start gap-2",ae()?"sm:grid-cols-2":"sm:grid-cols-1"))),b}}),null),t(ue,e(F,{get when(){return O()==="proxyProviders"},get children(){var b=_e();return t(b,e(U,{get each(){return p()},children:i=>{const A=x(()=>be(i.proxies.map(c=>c.name)??[],le())),X=[(()=>{var c=St(),N=c.firstChild,B=N.firstChild,q=B.nextSibling,G=N.nextSibling;return t(B,()=>i.name),t(q,()=>i.proxies.length),t(G,e(V,{class:"btn btn-circle btn-sm",get disabled(){return m()[i.name]},onClick:J=>W(J,i.name),get icon(){return e($e,{get class(){return R(m()[i.name]&&"animate-spin text-success")}})}}),null),t(G,e(V,{class:"btn btn-circle btn-sm",get disabled(){return P()[i.name]},onClick:J=>j(J,i.name),get icon(){return e(pe,{get class(){return R(P()[i.name]&&"animate-pulse text-success")}})}}),null),c})(),e($t,{get subscriptionInfo(){return i.subscriptionInfo}}),(()=>{var c=Tt(),N=c.firstChild,B=N.nextSibling;return B.nextSibling,t(c,()=>i.vehicleType,N),t(c,()=>n("updated"),B),t(c,()=>it(i.updatedAt),null),c})(),e(F,{get when(){return!y()[i.name]},get children(){return e(ye,{get proxyNameList(){return A()}})}})];return e(fe,{get isOpen(){return y()[i.name]},title:X,onCollapse:c=>Q(i.name,c),get children(){return e(U,{get each(){return A()},children:c=>e(xe,{proxyName:c})})}})}})),v(()=>te(b,R("grid grid-cols-1 place-items-start gap-2",ae()?"sm:grid-cols-2":"sm:grid-cols-1"))),b}}),null),t(f,e(dt,{ref:b=>r=b}),null),f})()]};rt(["click"]);export{Dt as default};
