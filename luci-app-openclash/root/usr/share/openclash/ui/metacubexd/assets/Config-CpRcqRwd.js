import{A as j,D as ne,a_ as re,b as X,y as se,u as B,d as l,i as e,ac as D,S as A,t as m,z as w,a$ as ie,c as Z,f as W,B as I,F as T,b0 as ce,r as J,b1 as $,a4 as oe,g as f,aa as N,b2 as de,b3 as ue,b4 as ge,b5 as be,b6 as he,b7 as pe,b8 as ve,b9 as fe,ba as me,bb as xe,bc as _e,bd as $e,be as O,bf as ke,bg as Ce,aZ as ye,k as Se,bh as we,bi as De,bj as z,bk as Ee,bl as H,bm as Ie,bn as Te,bo as Ae,bp as Le,bq as Pe,v as K,h as Ne,br as Fe}from"./index-Jq4vk9jB.js";import{D as Be}from"./DocumentTitle-CQWpQ_-K.js";const[Y,Ue]=j(""),U=ne(()=>Y().includes("sing-box")),je=()=>{re().then(Ue)};var Re=m('<div class="flex flex-col p-4">'),Ve=m('<div class="flex flex-col"><form class="flex gap-2 sm:flex-row"><input type=search name=name class="input input-bordered min-w-0 flex-1"placeholder=google.com><div class="flex items-center gap-2"><select name=type class="select select-bordered"><option>A</option><option>AAAA</option><option>MX'),Qe=m("<div class=py-2>"),Me=m('<form class="grid grid-cols-3 gap-2 sm:grid-cols-5">'),qe=m('<div class="grid grid-cols-2 gap-2 sm:grid-cols-4"><div class=form-control><label for=enable-allow-lan class="label gap-2"><span class=label-text></span></label><input id=enable-allow-lan type=checkbox class=toggle></div><div class=form-control><label for=enable-tun-device class="label gap-2"><span class=label-text></span></label><input id=enable-tun-device type=checkbox class=toggle></div><div class=form-control><label for=tun-ip-stack class="label gap-2"><span class=label-text></span></label><select id=tun-ip-stack class="select select-bordered flex-1"><option>Mixed</option><option>gVisor</option><option>System</option><option>LWIP</option></select></div><div class=form-control><label for=device-name class="label gap-2"><span class=label-text></span></label><input id=device-name class="input input-bordered min-w-0"></div><div class=form-control><label for=interface-name class="label gap-2"><span class=label-text></span></label><input id=interface-name class="input input-bordered min-w-0">'),Ge=m('<div class="flex flex-col gap-4"><select class="select select-bordered"></select><div class="grid grid-cols-2 gap-2 sm:grid-cols-3">'),F=m("<option>"),Oe=m('<div class=form-control><label class=label><span class=label-text></span></label><input type=number class="input input-bordered">'),ze=m('<div class="flex flex-col gap-2"><div class="flex flex-col"><select class="select select-bordered"></select></div><div class="flex flex-col"><select class="select select-bordered">'),He=m('<div class="grid grid-cols-1 gap-4 sm:grid-cols-2"><div class="flex flex-col gap-2"><div class="flex flex-col items-center"><input type=checkbox class=toggle></div><div class="flex flex-col"><select class="select select-bordered"></select></div><div class="flex flex-col"><div class="py-2 text-center text-lg font-semibold">&nbsp;</div></div></div><div class="flex flex-col gap-2"><div class="flex flex-col items-center"><input type=checkbox class=toggle>'),Xe=m('<span class="absolute -right-1 -top-1 flex h-3 w-3"><span class="absolute inline-flex h-full w-full animate-ping rounded-full bg-info opacity-75"></span><span class="inline-flex h-3 w-3 rounded-full bg-info">'),Ze=m('<div class="grid grid-cols-2 gap-4"><kbd class=kbd></kbd><div class=relative><kbd class="kbd w-full">'),We=m('<div class="mx-auto flex max-w-screen-md flex-col gap-4">');const Je=w.object({name:w.string(),type:w.string()}),Ke=()=>{const[t]=B(),p=ie(),{form:c,isSubmitting:x}=Z({extend:K({schema:Je}),onSubmit:n=>p.get("dns/query",{searchParams:{name:n.name,type:n.type}}).json().then(({Answer:g})=>d((g==null?void 0:g.map(({data:a})=>a))||[])).catch(g=>Ne.error(g.message))}),[k,d]=j([]);return(()=>{var n=Ve(),g=n.firstChild,a=g.firstChild,C=a.nextSibling;return C.firstChild,W(c,g,()=>c),e(C,l(I,{type:"submit",class:"btn-primary",get loading(){return x()},get children(){return t("dnsQuery")}}),null),e(n,l(A,{get when(){return k().length>0},get children(){var _=Re();return e(_,l(T,{get each(){return k()},children:s=>(()=>{var i=Qe();return e(i,s),i})()})),_}}),null),n})()},Ye=w.object({port:w.number(),"socks-port":w.number(),"redir-port":w.number(),"tproxy-port":w.number(),"mixed-port":w.number()}),el=()=>{const[t]=B(),p=[{label:()=>t("port",{name:"Mixed"}),key:"mixed-port",onChange:a=>void $("mixed-port",Number(a.target.value),n)},{label:()=>t("port",{name:"HTTP"}),key:"port",onChange:a=>void $("port",Number(a.target.value),n)},{label:()=>t("port",{name:"Socks"}),key:"socks-port",onChange:a=>void $("socks-port",Number(a.target.value),n)},{label:()=>t("port",{name:"Redir"}),key:"redir-port",onChange:a=>void $("redir-port",Number(a.target.value),n)},{label:()=>t("port",{name:"TProxy"}),key:"tproxy-port",onChange:a=>void $("tproxy-port",Number(a.target.value),n)}],{form:c,setInitialValues:x,reset:k}=Z({extend:K({schema:Ye})}),[d,{refetch:n}]=ce(Fe);J(()=>{const a=d();a&&(x(a),k())});const g=()=>{var a;return((a=d())==null?void 0:a.modes)||["rule","direct","global"]};return(()=>{var a=Ge(),C=a.firstChild,_=C.nextSibling;return C.addEventListener("change",s=>void $("mode",s.target.value,n)),e(C,l(T,{get each(){return g()},children:s=>(()=>{var i=F();return i.value=s,e(i,()=>t(s)??s),i})()})),e(a,l(A,{get when(){return!U()},get children(){return[(()=>{var s=Me();return W(c,s,()=>c),e(s,l(T,{each:p,children:i=>(()=>{var o=Oe(),b=o.firstChild,S=b.firstChild,y=b.nextSibling;return e(S,()=>i.label()),oe(y,"change",i.onChange),f(u=>{var h=i.key,v=i.key,L=i.key,P=i.label();return h!==u.e&&N(b,"for",u.e=h),v!==u.t&&N(y,"id",u.t=v),L!==u.a&&N(y,"name",u.a=L),P!==u.o&&N(y,"placeholder",u.o=P),u},{e:void 0,t:void 0,a:void 0,o:void 0}),o})()})),s})(),(()=>{var s=qe(),i=s.firstChild,o=i.firstChild,b=o.firstChild,S=o.nextSibling,y=i.nextSibling,u=y.firstChild,h=u.firstChild,v=u.nextSibling,L=y.nextSibling,P=L.firstChild,ee=P.firstChild,R=P.nextSibling,V=L.nextSibling,Q=V.firstChild,le=Q.firstChild,M=Q.nextSibling,te=V.nextSibling,q=te.firstChild,ae=q.firstChild,G=q.nextSibling;return e(b,()=>t("allowLan")),S.addEventListener("change",r=>void $("allow-lan",r.target.checked,n)),e(h,()=>t("enableTunDevice")),v.addEventListener("change",r=>void $("tun",{enable:r.target.checked},n)),e(ee,()=>t("tunModeStack")),R.addEventListener("change",r=>void $("tun",{stack:r.target.value},n)),e(le,()=>t("tunDeviceName")),M.addEventListener("change",r=>void $("tun",{device:r.target.value},n)),e(ae,()=>t("interfaceName")),G.addEventListener("change",r=>void $("interface-name",r.target.value,n)),f(()=>{var r;return S.checked=(r=d())==null?void 0:r["allow-lan"]}),f(()=>{var r,E;return v.checked=(E=(r=d())==null?void 0:r.tun)==null?void 0:E.enable}),f(()=>{var r,E;return R.value=(E=(r=d())==null?void 0:r.tun)==null?void 0:E.stack}),f(()=>{var r,E;return M.value=(E=(r=d())==null?void 0:r.tun)==null?void 0:E.device}),f(()=>{var r;return G.value=(r=d())==null?void 0:r["interface-name"]}),s})()]}}),_),e(_,l(I,{class:"btn-primary",get loading(){return de()},onClick:ue,get children(){return t("reloadConfig")}}),null),e(_,l(I,{class:"btn-accent",get loading(){return ge()},onClick:be,get children(){return t("flushFakeIP")}}),null),e(_,l(I,{class:"btn-warning",get loading(){return he()},onClick:pe,get children(){return t("restartCore")}}),null),e(_,l(A,{get when(){return!U()},get children(){return[l(I,{class:"btn-secondary",get loading(){return ve()},onClick:fe,get children(){return t("updateGEODatabases")}}),l(I,{class:"btn-info",get loading(){return me()},onClick:xe,get children(){return t("upgradeUI")}}),l(I,{class:"btn-error",get loading(){return _e()},onClick:$e,get children(){return t("upgradeCore")}})]}}),null),f(()=>{var s;return C.value=(s=d())==null?void 0:s.mode}),a})()},ll=()=>{const[t]=B(),p=X(),c=[{label:()=>t("en"),value:O.EN},{label:()=>t("zh"),value:O.ZH}];return(()=>{var x=He(),k=x.firstChild,d=k.firstChild,n=d.firstChild,g=d.nextSibling,a=g.firstChild,C=g.nextSibling;C.firstChild;var _=k.nextSibling,s=_.firstChild,i=s.firstChild;return e(d,l(D,{get children(){return t("useTwemoji")}}),n),n.addEventListener("change",o=>ke(o.target.checked)),e(g,l(D,{get children(){return t("switchLanguage")}}),a),a.addEventListener("change",o=>Ce(o.target.value)),e(a,l(T,{each:c,children:o=>(()=>{var b=F();return e(b,()=>o.label()),f(()=>b.selected=ye()===o.value),f(()=>b.value=o.value),b})()})),e(C,l(I,{class:"btn-info",onClick:()=>{Se(""),p(we.Setup)},get children(){return t("switchEndpoint")}}),null),e(s,l(D,{get children(){return t("autoSwitchTheme")}}),i),i.addEventListener("change",o=>De(o.target.checked)),e(_,l(A,{get when(){return z()},get children(){var o=ze(),b=o.firstChild,S=b.firstChild,y=b.nextSibling,u=y.firstChild;return e(b,l(D,{get children(){return t("favDayTheme")}}),S),S.addEventListener("change",h=>Ee(h.target.value)),e(S,l(T,{each:H,children:h=>(()=>{var v=F();return v.value=h,e(v,h),v})()})),e(y,l(D,{get children(){return t("favNightTheme")}}),u),u.addEventListener("change",h=>Ie(h.target.value)),e(u,l(T,{each:H,children:h=>(()=>{var v=F();return v.value=h,e(v,h),v})()})),f(()=>S.value=Te()),f(()=>u.value=Ae()),o}}),null),f(()=>n.checked=Le()),f(()=>i.checked=z()),x})()},tl=({backendVersion:t})=>{const[p,c]=j(!1);return J(async()=>{const x=t();x&&c(await Pe(x))}),(()=>{var x=Ze(),k=x.firstChild,d=k.nextSibling,n=d.firstChild;return e(k,()=>"1.153.2"),e(d,l(A,{get when(){return p()},get children(){return Xe()}}),n),e(n,t),x})()},rl=()=>{const t=X();if(!se())return t("/setup",{replace:!0}),null;const[p]=B();return je(),[l(Be,{get children(){return p("config")}}),(()=>{var c=We();return e(c,l(A,{get when(){return!U()},get children(){return[l(D,{withDivider:!0,get children(){return p("dnsQuery")}}),l(Ke,{})]}}),null),e(c,l(D,{withDivider:!0,get children(){return p("coreConfig")}}),null),e(c,l(el,{}),null),e(c,l(D,{withDivider:!0,get children(){return p("xdConfig")}}),null),e(c,l(ll,{}),null),e(c,l(D,{withDivider:!0,get children(){return p("version")}}),null),e(c,l(tl,{backendVersion:Y}),null),c})()]};export{rl as default};
