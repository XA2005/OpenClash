import{A as j,D as ne,b0 as re,b as X,y as se,u as B,d as t,i as e,ac as D,S as A,t as m,z as w,b1 as ie,c as W,f as Z,B as I,F as T,b2 as ce,r as J,b3 as _,a4 as oe,g as f,aa as N,b4 as de,b5 as ue,b6 as ge,b7 as be,b8 as he,b9 as pe,ba as ve,bb as fe,bc as me,bd as xe,be as $e,bf as _e,bg as O,bh as ke,bi as Ce,a$ as ye,k as Se,bj as we,bk as De,bl as z,bm as Ee,bn as H,bo as Ie,bp as Te,bq as Ae,br as Le,bs as Pe,v as K,h as Ne,bt as Fe}from"./index-BUuZZGdr.js";import{D as Be}from"./DocumentTitle-BsE74FyM.js";const[Y,Ue]=j(""),U=ne(()=>Y().includes("sing-box")),je=()=>{re().then(Ue)};var Re=m('<div class="flex flex-col p-4">'),Ve=m('<div class="flex flex-col"><form class="flex gap-2 sm:flex-row"><input type=search name=name class="input input-bordered min-w-0 flex-1"placeholder=google.com><div class="flex items-center gap-2"><select name=type class="select select-bordered"><option>A</option><option>AAAA</option><option>MX'),Qe=m("<div class=py-2>"),Me=m('<form class="grid grid-cols-3 gap-2 sm:grid-cols-5">'),qe=m('<div class="grid grid-cols-2 gap-2 sm:grid-cols-4"><div class=form-control><label for=enable-allow-lan class="label gap-2"><span class=label-text></span></label><input id=enable-allow-lan type=checkbox class=toggle></div><div class=form-control><label for=enable-tun-device class="label gap-2"><span class=label-text></span></label><input id=enable-tun-device type=checkbox class=toggle></div><div class=form-control><label for=tun-ip-stack class="label gap-2"><span class=label-text></span></label><select id=tun-ip-stack class="select select-bordered flex-1"><option>Mixed</option><option>gVisor</option><option>System</option><option>LWIP</option></select></div><div class=form-control><label for=device-name class="label gap-2"><span class=label-text></span></label><input id=device-name class="input input-bordered min-w-0"></div><div class=form-control><label for=interface-name class="label gap-2"><span class=label-text></span></label><input id=interface-name class="input input-bordered min-w-0">'),Ge=m('<div class="flex flex-col gap-4"><select class="select select-bordered"></select><div class="grid grid-cols-2 gap-2 sm:grid-cols-3">'),F=m("<option>"),Oe=m('<div class=form-control><label class=label><span class=label-text></span></label><input type=number class="input input-bordered">'),ze=m('<div class="flex flex-col gap-2"><div class="flex flex-col"><select class="select select-bordered"></select></div><div class="flex flex-col"><select class="select select-bordered">'),He=m('<div class="grid grid-cols-1 gap-4 sm:grid-cols-2"><div class="flex flex-col gap-2"><div class="flex flex-col items-center"><input type=checkbox class=toggle></div><div class="flex flex-col"><select class="select select-bordered"></select></div><div class="flex flex-col"><div class="py-2 text-center text-lg font-semibold">&nbsp;</div></div></div><div class="flex flex-col gap-2"><div class="flex flex-col items-center"><input type=checkbox class=toggle>'),Xe=m('<span class="absolute -right-1 -top-1 flex h-3 w-3"><span class="absolute inline-flex h-full w-full animate-ping rounded-full bg-info opacity-75"></span><span class="inline-flex h-3 w-3 rounded-full bg-info">'),We=m('<div class="grid grid-cols-2 gap-4"><kbd class=kbd></kbd><div class=relative><kbd class="kbd w-full">'),Ze=m('<div class="mx-auto flex max-w-screen-md flex-col gap-4">');const Je=w.object({name:w.string(),type:w.string()}),Ke=()=>{const[l]=B(),p=ie(),{form:c,isSubmitting:x}=W({extend:K({schema:Je}),onSubmit:n=>p.get("dns/query",{searchParams:{name:n.name,type:n.type}}).json().then(({Answer:g})=>d((g==null?void 0:g.map(({data:a})=>a))||[])).catch(g=>Ne.error(g.message))}),[k,d]=j([]);return(()=>{var n=Ve(),g=n.firstChild,a=g.firstChild,C=a.nextSibling;return C.firstChild,Z(c,g,()=>c),e(C,t(I,{type:"submit",class:"btn-primary",get loading(){return x()},get children(){return l("dnsQuery")}}),null),e(n,t(A,{get when(){return k().length>0},get children(){var $=Re();return e($,t(T,{get each(){return k()},children:s=>(()=>{var i=Qe();return e(i,s),i})()})),$}}),null),n})()},Ye=w.object({port:w.number(),"socks-port":w.number(),"redir-port":w.number(),"tproxy-port":w.number(),"mixed-port":w.number()}),et=()=>{const[l]=B(),p=[{label:()=>l("port",{name:"Mixed"}),key:"mixed-port",onChange:a=>void _("mixed-port",Number(a.target.value),n)},{label:()=>l("port",{name:"HTTP"}),key:"port",onChange:a=>void _("port",Number(a.target.value),n)},{label:()=>l("port",{name:"Socks"}),key:"socks-port",onChange:a=>void _("socks-port",Number(a.target.value),n)},{label:()=>l("port",{name:"Redir"}),key:"redir-port",onChange:a=>void _("redir-port",Number(a.target.value),n)},{label:()=>l("port",{name:"TProxy"}),key:"tproxy-port",onChange:a=>void _("tproxy-port",Number(a.target.value),n)}],{form:c,setInitialValues:x,reset:k}=W({extend:K({schema:Ye})}),[d,{refetch:n}]=ce(Fe);J(()=>{const a=d();a&&(x(a),k())});const g=()=>{var a;return((a=d())==null?void 0:a.modes)||["rule","direct","global"]};return(()=>{var a=Ge(),C=a.firstChild,$=C.nextSibling;return C.addEventListener("change",s=>void _("mode",s.target.value,n)),e(C,t(T,{get each(){return g()},children:s=>(()=>{var i=F();return i.value=s,e(i,()=>l(s)??s),i})()})),e(a,t(A,{get when(){return!U()},get children(){return[(()=>{var s=Me();return Z(c,s,()=>c),e(s,t(T,{each:p,children:i=>(()=>{var o=Oe(),b=o.firstChild,S=b.firstChild,y=b.nextSibling;return e(S,()=>i.label()),oe(y,"change",i.onChange),f(u=>{var h=i.key,v=i.key,L=i.key,P=i.label();return h!==u.e&&N(b,"for",u.e=h),v!==u.t&&N(y,"id",u.t=v),L!==u.a&&N(y,"name",u.a=L),P!==u.o&&N(y,"placeholder",u.o=P),u},{e:void 0,t:void 0,a:void 0,o:void 0}),o})()})),s})(),(()=>{var s=qe(),i=s.firstChild,o=i.firstChild,b=o.firstChild,S=o.nextSibling,y=i.nextSibling,u=y.firstChild,h=u.firstChild,v=u.nextSibling,L=y.nextSibling,P=L.firstChild,ee=P.firstChild,R=P.nextSibling,V=L.nextSibling,Q=V.firstChild,te=Q.firstChild,M=Q.nextSibling,le=V.nextSibling,q=le.firstChild,ae=q.firstChild,G=q.nextSibling;return e(b,()=>l("allowLan")),S.addEventListener("change",r=>void _("allow-lan",r.target.checked,n)),e(h,()=>l("enableTunDevice")),v.addEventListener("change",r=>void _("tun",{enable:r.target.checked},n)),e(ee,()=>l("tunModeStack")),R.addEventListener("change",r=>void _("tun",{stack:r.target.value},n)),e(te,()=>l("tunDeviceName")),M.addEventListener("change",r=>void _("tun",{device:r.target.value},n)),e(ae,()=>l("interfaceName")),G.addEventListener("change",r=>void _("interface-name",r.target.value,n)),f(()=>{var r;return S.checked=(r=d())==null?void 0:r["allow-lan"]}),f(()=>{var r,E;return v.checked=(E=(r=d())==null?void 0:r.tun)==null?void 0:E.enable}),f(()=>{var r,E;return R.value=(E=(r=d())==null?void 0:r.tun)==null?void 0:E.stack}),f(()=>{var r,E;return M.value=(E=(r=d())==null?void 0:r.tun)==null?void 0:E.device}),f(()=>{var r;return G.value=(r=d())==null?void 0:r["interface-name"]}),s})()]}}),$),e($,t(I,{class:"btn-primary",get loading(){return de()},onClick:ue,get children(){return l("reloadConfig")}}),null),e($,t(I,{class:"btn-accent",get loading(){return ge()},onClick:be,get children(){return l("flushFakeIP")}}),null),e($,t(I,{class:"btn-warning",get loading(){return he()},onClick:pe,get children(){return l("restartCore")}}),null),e($,t(A,{get when(){return!U()},get children(){return[t(I,{class:"btn-secondary",get loading(){return ve()},onClick:fe,get children(){return l("updateGEODatabases")}}),t(I,{class:"btn-info",get loading(){return me()},onClick:xe,get children(){return l("upgradeUI")}}),t(I,{class:"btn-error",get loading(){return $e()},onClick:_e,get children(){return l("upgradeCore")}})]}}),null),f(()=>{var s;return C.value=(s=d())==null?void 0:s.mode}),a})()},tt=()=>{const[l]=B(),p=X(),c=[{label:()=>l("en"),value:O.EN},{label:()=>l("zh"),value:O.ZH}];return(()=>{var x=He(),k=x.firstChild,d=k.firstChild,n=d.firstChild,g=d.nextSibling,a=g.firstChild,C=g.nextSibling;C.firstChild;var $=k.nextSibling,s=$.firstChild,i=s.firstChild;return e(d,t(D,{get children(){return l("useTwemoji")}}),n),n.addEventListener("change",o=>ke(o.target.checked)),e(g,t(D,{get children(){return l("switchLanguage")}}),a),a.addEventListener("change",o=>Ce(o.target.value)),e(a,t(T,{each:c,children:o=>(()=>{var b=F();return e(b,()=>o.label()),f(()=>b.selected=ye()===o.value),f(()=>b.value=o.value),b})()})),e(C,t(I,{class:"btn-info",onClick:()=>{Se(""),p(we.Setup)},get children(){return l("switchEndpoint")}}),null),e(s,t(D,{get children(){return l("autoSwitchTheme")}}),i),i.addEventListener("change",o=>De(o.target.checked)),e($,t(A,{get when(){return z()},get children(){var o=ze(),b=o.firstChild,S=b.firstChild,y=b.nextSibling,u=y.firstChild;return e(b,t(D,{get children(){return l("favDayTheme")}}),S),S.addEventListener("change",h=>Ee(h.target.value)),e(S,t(T,{each:H,children:h=>(()=>{var v=F();return v.value=h,e(v,h),v})()})),e(y,t(D,{get children(){return l("favNightTheme")}}),u),u.addEventListener("change",h=>Ie(h.target.value)),e(u,t(T,{each:H,children:h=>(()=>{var v=F();return v.value=h,e(v,h),v})()})),f(()=>S.value=Te()),f(()=>u.value=Ae()),o}}),null),f(()=>n.checked=Le()),f(()=>i.checked=z()),x})()},lt=({backendVersion:l})=>{const[p,c]=j(!1);return J(async()=>{const x=l();x&&c(await Pe(x))}),(()=>{var x=We(),k=x.firstChild,d=k.nextSibling,n=d.firstChild;return e(k,()=>"1.152.0"),e(d,t(A,{get when(){return p()},get children(){return Xe()}}),n),e(n,l),x})()},rt=()=>{const l=X();if(!se())return l("/setup",{replace:!0}),null;const[p]=B();return je(),[t(Be,{get children(){return p("config")}}),(()=>{var c=Ze();return e(c,t(A,{get when(){return!U()},get children(){return[t(D,{withDivider:!0,get children(){return p("dnsQuery")}}),t(Ke,{})]}}),null),e(c,t(D,{withDivider:!0,get children(){return p("coreConfig")}}),null),e(c,t(et,{}),null),e(c,t(D,{withDivider:!0,get children(){return p("xdConfig")}}),null),e(c,t(tt,{}),null),e(c,t(D,{withDivider:!0,get children(){return p("version")}}),null),e(c,t(lt,{backendVersion:Y}),null),c})()]};export{rt as default};
