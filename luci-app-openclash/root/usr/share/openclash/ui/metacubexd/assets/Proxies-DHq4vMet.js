import{u as G,d as e,ao as Ne,i as t,ac as D,ap as Ee,aq as De,D as x,ar as Ie,as as Me,at as ke,F,au as Oe,av as Ae,aw as Be,ax as j,ay as Fe,az as He,g as p,aA as Re,aB as Ue,aC as je,aD as Ye,aE as re,aF as xe,aG as Z,aH as $e,aI as ye,Q as ze,t as v,aJ as Qe,aK as oe,S as B,aL as I,aM as _e,aN as se,a0 as Y,$ as we,aa as Ce,H as ie,E as Ke,W as We,b as Xe,y as qe,R as Je,T as Ve,A as ue,o as Ze,B as X,a3 as Ge,aO as et,aP as ge,aQ as ve,aR as he,aS as me,m as tt}from"./index-Dty2i_OM.js";import{f as nt}from"./global-BFD_DWKr.js";import{D as rt}from"./DocumentTitle-C4frZ0JS.js";import{I as be}from"./IconReload-DBLu9NBj.js";var it=v('<div class="flex flex-col gap-4"><div><div class="flex w-full justify-center"><input class=toggle type=checkbox></div></div><div class="flex flex-col"><input class="input input-bordered w-full"></div><div><input type=number class="input input-bordered w-full"></div><div class="flex flex-col"><input class="input input-bordered w-full"></div><div><select class="select select-bordered w-full"></select></div><div><div class="flex w-full justify-center"><input class=toggle type=checkbox></div></div><div><select class="select select-bordered w-full"></select></div><div><input type=number class="input input-bordered w-full"><input type=number class="input input-bordered w-full">'),st=v('<option class="flex items-center gap-2">'),lt=v("<option>");const at=s=>{const[r]=G();return e(ze,{ref:n=>{var l;return(l=s.ref)==null?void 0:l.call(s,n)},get icon(){return e(Ne,{size:24})},get title(){return r("proxiesSettings")},get children(){var n=it(),l=n.firstChild,d=l.firstChild,u=d.firstChild,m=l.nextSibling,L=m.firstChild,o=m.nextSibling,M=o.firstChild,$=o.nextSibling,C=$.firstChild,P=$.nextSibling,S=P.firstChild,h=P.nextSibling,N=h.firstChild,k=N.firstChild,y=h.nextSibling,T=y.firstChild,R=y.nextSibling,U=R.firstChild,z=U.nextSibling;return t(l,e(D,{withDivider:!0,get children(){return r("autoCloseConns")}}),d),u.addEventListener("change",a=>Ee(a.target.checked)),t(m,e(D,{withDivider:!0,get children(){return r("urlForLatencyTest")}}),L),L.addEventListener("change",a=>De(a.target.value)),t(o,e(D,{withDivider:!0,get children(){return[x(()=>r("latencyTestTimeoutDuration"))," (",x(()=>r("ms")),")"]}}),M),M.addEventListener("change",a=>Ie(Number(a.target.value))),t($,e(D,{withDivider:!0,get children(){return r("urlForIPv6SupportTest")}}),C),C.addEventListener("change",a=>{var _;return Me((_=a.target.value)==null?void 0:_.trim())}),t(P,e(D,{withDivider:!0,get children(){return r("proxiesSorting")}}),S),S.addEventListener("change",a=>ke(a.target.value)),t(S,e(F,{get each(){return Object.values(Oe)},children:a=>(()=>{var _=st();return _.value=a,t(_,()=>r(a)),_})()})),t(h,e(D,{withDivider:!0,get children(){return r("hideUnavailableProxies")}}),N),k.addEventListener("change",a=>Ae(a.target.checked)),t(y,e(D,{withDivider:!0,get children(){return r("proxiesPreviewType")}}),T),T.addEventListener("change",a=>Be(a.target.value)),t(T,e(F,{get each(){return Object.values(j)},children:a=>(()=>{var _=lt();return _.value=a,t(_,()=>r(a)),_})()})),t(R,e(D,{withDivider:!0,get children(){return r("iconHeight")}}),U),U.addEventListener("change",a=>Fe(Number(a.target.value))),t(R,e(D,{withDivider:!0,get children(){return r("iconMarginRight")}}),z),z.addEventListener("change",a=>He(Number(a.target.value))),p(()=>u.checked=Re()),p(()=>L.value=Ue()),p(()=>M.value=je()),p(()=>C.value=Ye()),p(()=>S.value=re()),p(()=>k.checked=xe()),p(()=>T.value=Z()),p(()=>U.value=$e()),p(()=>z.value=ye()),n}})},fe=s=>{const r=()=>Z()===j.OFF,n=x(()=>s.proxyNameList.length<=10),l=x(()=>{const u=Z();return u===j.BAR||u===j.Auto&&!n()}),d=x(()=>{const u=Z();return u===j.DOTS||u===j.Auto&&n()});return e(B,{get when(){return!r()},get children(){return e(Qe,{get children(){return[e(oe,{get when(){return l()},get children(){return e(dt,{get proxyNameList(){return s.proxyNameList},get now(){return s.now}})}}),e(oe,{get when(){return d()},get children(){return e(vt,{get proxyNameList(){return s.proxyNameList},get now(){return s.now}})}})]}})}})};var ct=v('<div class="flex items-center gap-2 py-2"><div class="my-1 flex flex-1 items-center justify-center overflow-hidden rounded-2xl [&amp;>*]:h-2"><div class=bg-success></div><div class=bg-warning></div><div class=bg-error></div><div class=bg-neutral>');const dt=s=>{const{getLatencyByName:r}=se(),n=x(()=>s.proxyNameList.map(o=>r(o))),l=x(()=>n().length),d=x(()=>n().filter(o=>o>I().NOT_CONNECTED&&o<=I().MEDIUM).length),u=x(()=>n().filter(o=>o>I().MEDIUM&&o<=I().HIGH).length),m=x(()=>n().filter(o=>o>I().HIGH).length),L=x(()=>n().filter(o=>o===I().NOT_CONNECTED).length);return(()=>{var o=ct(),M=o.firstChild,$=M.firstChild,C=$.nextSibling,P=C.nextSibling,S=P.nextSibling;return t(o,e(_e,{get name(){return s.now}}),null),p(h=>{var N=`${d()*100/l()}%`,k=`${u()*100/l()}%`,y=`${m()*100/l()}%`,T=`${L()*100/l()}%`;return N!==h.e&&((h.e=N)!=null?$.style.setProperty("width",N):$.style.removeProperty("width")),k!==h.t&&((h.t=k)!=null?C.style.setProperty("width",k):C.style.removeProperty("width")),y!==h.a&&((h.a=y)!=null?P.style.setProperty("width",y):P.style.removeProperty("width")),T!==h.o&&((h.o=T)!=null?S.style.setProperty("width",T):S.style.removeProperty("width")),h},{e:void 0,t:void 0,a:void 0,o:void 0}),o})()};var ot=v("<div>"),ut=v('<div class="flex items-center gap-2 py-2"><div class="flex flex-1 flex-wrap items-center gap-1">');const gt=s=>{let r=s.selected?"bg-white border-4 border-success":"bg-success";return typeof s.latency!="number"||s.latency===I().NOT_CONNECTED?r=s.selected?"bg-white border-4 border-neutral":"bg-neutral":s.latency>I().HIGH?r=s.selected?"bg-white border-4 border-error":"bg-error":s.latency>I().MEDIUM&&(r=s.selected?"bg-white border-4 border-warning":"bg-warning"),(()=>{var n=ot();return p(l=>{var d=Y("h-4 w-4 rounded-full",r),u=s.name;return d!==l.e&&we(n,l.e=d),u!==l.t&&Ce(n,"title",l.t=u),l},{e:void 0,t:void 0}),n})()},vt=s=>{const{getLatencyByName:r}=se();return(()=>{var n=ut(),l=n.firstChild;return t(l,e(F,{get each(){return s.proxyNameList.map(d=>[d,r(d)])},children:([d,u])=>{const m=s.now===d;return e(gt,{name:d,latency:u,selected:m})}})),t(n,e(_e,{get name(){return s.now}}),null),n})()};var ht=v("<progress class=progress max=100>"),mt=v('<div class="text-sm text-slate-500"> / <!> ( <!>% )'),bt=v('<div class="text-sm text-slate-500">: ');const ft=s=>{const{Download:r=0,Upload:n=0,Total:l=0,Expire:d=0}=s,u=ie(l,{units:"iec"}),m=ie(r+n,{units:"iec"}),L=Ke.toFinite(((r+n)/l*100).toFixed(2));return{total:u,used:m,percentage:L,expirePrefix:()=>{const[$]=G();return $("expire")},expireStr:()=>{const[$]=G();return d===0?$("noExpire"):We(d*1e3).format("YYYY-MM-DD")}}},pt=s=>{if(!s.subscriptionInfo)return;const r=ft(s.subscriptionInfo);return[(()=>{var n=ht();return p(()=>n.value=r.percentage),n})(),(()=>{var n=mt(),l=n.firstChild,d=l.nextSibling,u=d.nextSibling,m=u.nextSibling;return m.nextSibling,t(n,()=>`${r.used}`,l),t(n,()=>`${r.total}`,d),t(n,()=>r.percentage,m),n})(),(()=>{var n=bt(),l=n.firstChild;return t(n,()=>r.expirePrefix(),l),t(n,()=>r.expireStr(),null),n})()]};var pe=v('<div class="grid grid-cols-1 place-items-start gap-2 sm:grid-cols-2">'),xt=v('<div class="flex h-full flex-col gap-2"><div class="flex items-center gap-2"><div class="tabs-boxed tabs gap-2"></div><div class=ml-auto></div></div><div class="flex-1 overflow-y-auto">'),$t=v('<button><span></span><div class="badge badge-sm">'),yt=v("<img>"),_t=v("<pre>"),wt=v('<div class=space-y-2><div class="flex items-center justify-between pr-8"><div class="flex items-center"><span></span><div class="badge badge-sm ml-2"></div></div></div><div class="flex flex-wrap items-center justify-between gap-2"><div class="badge badge-primary badge-sm"><span class=font-bold></span></div><div class="badge badge-secondary badge-sm">/s'),Ct=v('<div class="flex items-center justify-between pr-8"><div class="flex items-center gap-2"><span></span><div class="badge badge-sm"></div></div><div class="flex items-center gap-2">'),Pt=v('<div class="text-sm text-slate-500"> :: <!> ');const Et=()=>{const s=Xe();if(!qe())return s("/setup",{replace:!0}),null;let r;const[n]=G(),{fetchProxies:l,proxies:d,selectProxyInGroup:u,proxyProviders:m,updateProviderByProviderName:L,updateAllProvider:o,proxyGroupLatencyTest:M,proxyProviderLatencyTest:$,proxyGroupLatencyTestingMap:C,proxyProviderLatencyTestingMap:P,isAllProviderUpdating:S,updatingMap:h}=se(),N=x(()=>d().filter(b=>!b.hidden)),{speedGroupByName:k}=Je(),[y,T]=Ve(ue({}),{name:"collapsedMap",storage:localStorage}),R=(b,w)=>{T(J=>({...J,[b]:w}))};Ze(l);const U=async(b,w)=>{b.stopPropagation(),M(w)},z=(b,w)=>{b.stopPropagation(),$(w)},a=(b,w)=>{b.stopPropagation(),L(w)},_=async b=>{b.stopPropagation(),o()},[q,Pe]=ue("proxies"),Se=()=>[{type:"proxies",name:n("proxies"),count:N().length},{type:"proxyProviders",name:n("proxyProviders"),count:m().length}];return[e(rt,{get children(){return n("proxies")}}),(()=>{var b=xt(),w=b.firstChild,J=w.firstChild,le=J.nextSibling,ae=w.nextSibling;return t(J,e(F,{get each(){return Se()},children:f=>(()=>{var i=$t(),O=i.firstChild,Q=O.nextSibling;return i.$$click=()=>Pe(f.type),t(O,()=>f.name),t(Q,()=>f.count),p(()=>we(i,Y(q()===f.type&&"tab-active","tab-sm sm:tab-md tab gap-2 px-2"))),i})()})),t(w,e(B,{get when(){return q()==="proxyProviders"},get children(){return e(X,{class:"btn btn-circle btn-sm",get disabled(){return S()},onClick:f=>_(f),get icon(){return e(be,{get class(){return Y(S()&&"animate-spin text-success")}})}})}}),le),t(le,e(X,{class:"btn-circle btn-primary btn-sm",onClick:()=>r==null?void 0:r.showModal(),get icon(){return e(Ge,{})}})),t(ae,e(B,{get when(){return q()==="proxies"},get children(){var f=pe();return t(f,e(F,{get each(){return N()},children:i=>{const O=x(()=>et(ge(i.all??[],re()),xe())),Q=(()=>{var c=wt(),E=c.firstChild,A=E.firstChild,K=A.firstChild,V=K.nextSibling,W=E.nextSibling,ee=W.firstChild,Te=ee.firstChild,ce=ee.nextSibling,Le=ce.firstChild;return t(A,e(B,{get when(){return i.icon},get children(){var g=yt();return p(H=>{var de=i.icon,te=`${$e()}px`,ne=`${ye()}px`;return de!==H.e&&Ce(g,"src",H.e=de),te!==H.t&&((H.t=te)!=null?g.style.setProperty("height",te):g.style.removeProperty("height")),ne!==H.a&&((H.a=ne)!=null?g.style.setProperty("margin-right",ne):g.style.removeProperty("margin-right")),H},{e:void 0,t:void 0,a:void 0}),g}}),K),t(K,()=>i.name),t(V,()=>{var g;return(g=i.all)==null?void 0:g.length}),t(E,e(X,{class:"btn-circle btn-sm",get disabled(){return C()[i.name]},onClick:g=>U(g,i.name),get icon(){return e(ve,{get class(){return Y(C()[i.name]&&"animate-pulse text-success")}})}}),null),t(Te,()=>i.type),t(ee,e(B,{get when(){var g;return((g=i.now)==null?void 0:g.length)>0},get children(){var g=_t();return t(g,()=>` :: ${i.now}`),g}}),null),t(ce,()=>ie(k()[i.name]??0).toString(),Le),t(c,e(B,{get when(){return!y()[i.name]},get children(){return e(fe,{get proxyNameList(){return O()},get now(){return i.now}})}}),null),c})();return e(he,{get isOpen(){return y()[i.name]},title:Q,onCollapse:c=>R(i.name,c),get children(){return e(F,{get each(){return O()},children:c=>e(me,{proxyName:c,get isSelected(){return i.now===c},onClick:()=>void u(i,c)})})}})}})),f}}),null),t(ae,e(B,{get when(){return q()==="proxyProviders"},get children(){var f=pe();return t(f,e(F,{get each(){return m()},children:i=>{const O=x(()=>ge(i.proxies.map(c=>c.name)??[],re())),Q=[(()=>{var c=Ct(),E=c.firstChild,A=E.firstChild,K=A.nextSibling,V=E.nextSibling;return t(A,()=>i.name),t(K,()=>i.proxies.length),t(V,e(X,{class:"btn btn-circle btn-sm",get disabled(){return h()[i.name]},onClick:W=>a(W,i.name),get icon(){return e(be,{get class(){return Y(h()[i.name]&&"animate-spin text-success")}})}}),null),t(V,e(X,{class:"btn btn-circle btn-sm",get disabled(){return P()[i.name]},onClick:W=>z(W,i.name),get icon(){return e(ve,{get class(){return Y(P()[i.name]&&"animate-pulse text-success")}})}}),null),c})(),e(pt,{get subscriptionInfo(){return i.subscriptionInfo}}),(()=>{var c=Pt(),E=c.firstChild,A=E.nextSibling;return A.nextSibling,t(c,()=>i.vehicleType,E),t(c,()=>n("updated"),A),t(c,()=>nt(i.updatedAt),null),c})(),e(B,{get when(){return!y()[i.name]},get children(){return e(fe,{get proxyNameList(){return O()}})}})];return e(he,{get isOpen(){return y()[i.name]},title:Q,onCollapse:c=>R(i.name,c),get children(){return e(F,{get each(){return O()},children:c=>e(me,{proxyName:c})})}})}})),f}}),null),t(b,e(at,{ref:f=>r=f}),null),b})()]};tt(["click"]);export{Et as default};
