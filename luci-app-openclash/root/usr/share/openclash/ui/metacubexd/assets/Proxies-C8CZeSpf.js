import{u as ee,d as e,ao as Ce,i as t,ac as N,ap as Pe,aq as Se,D as $,ar as Te,as as Le,at as Ee,F as U,au as Ne,av as Ie,aw as De,ax as Me,ay as Q,az as ke,aA as Oe,g,aB as Ae,aC as Be,aD as Fe,aE as Re,aF as ne,aG as xe,aH as ie,aI as Z,aJ as $e,aK as ye,Q as Ue,t as v,aL as He,aM as de,S as H,aN as M,aO as _e,aP as le,a0 as R,$ as G,aa as we,H as se,E as je,W as Ye,b as ze,y as Qe,R as Ke,T as We,A as ue,o as Xe,B as J,a3 as qe,aQ as Je,aR as ge,aS as ve,aT as he,aU as me,l as Ve}from"./index-BUuZZGdr.js";import{f as Ze}from"./global-C7BdpSTv.js";import{D as Ge}from"./DocumentTitle-BsE74FyM.js";import{I as fe}from"./IconReload-B9c0Cyol.js";var et=v('<div class="flex flex-col gap-4"><div><div class="flex w-full justify-center"><input class=toggle type=checkbox></div></div><div class="flex flex-col"><input class="input input-bordered w-full"></div><div><input type=number class="input input-bordered w-full"></div><div class="flex flex-col"><input class="input input-bordered w-full"></div><div><select class="select select-bordered w-full"></select></div><div><div class="flex w-full justify-center"><input class=toggle type=checkbox></div></div><div><div class="flex w-full justify-center"><input class=toggle type=checkbox></div></div><div><select class="select select-bordered w-full"></select></div><div><input type=number class="input input-bordered w-full"><input type=number class="input input-bordered w-full">'),tt=v('<option class="flex items-center gap-2">'),rt=v("<option>");const nt=s=>{const[n]=ee();return e(Ue,{ref:r=>{var l;return(l=s.ref)==null?void 0:l.call(s,r)},get icon(){return e(Ce,{size:24})},get title(){return n("proxiesSettings")},get children(){var r=et(),l=r.firstChild,o=l.firstChild,u=o.firstChild,b=l.nextSibling,I=b.firstChild,d=b.nextSibling,k=d.firstChild,y=d.nextSibling,T=y.firstChild,L=y.nextSibling,E=L.firstChild,h=L.nextSibling,D=h.firstChild,O=D.firstChild,w=h.nextSibling,A=w.firstChild,K=A.firstChild,W=w.nextSibling,j=W.firstChild,X=W.nextSibling,Y=X.firstChild,B=Y.nextSibling;return t(l,e(N,{withDivider:!0,get children(){return n("autoCloseConns")}}),o),u.addEventListener("change",a=>Pe(a.target.checked)),t(b,e(N,{withDivider:!0,get children(){return n("urlForLatencyTest")}}),I),I.addEventListener("change",a=>Se(a.target.value)),t(d,e(N,{withDivider:!0,get children(){return[$(()=>n("latencyTestTimeoutDuration"))," (",$(()=>n("ms")),")"]}}),k),k.addEventListener("change",a=>Te(Number(a.target.value))),t(y,e(N,{withDivider:!0,get children(){return n("urlForIPv6SupportTest")}}),T),T.addEventListener("change",a=>{var C;return Le((C=a.target.value)==null?void 0:C.trim())}),t(L,e(N,{withDivider:!0,get children(){return n("proxiesSorting")}}),E),E.addEventListener("change",a=>Ee(a.target.value)),t(E,e(U,{get each(){return Object.values(Ne)},children:a=>(()=>{var C=tt();return C.value=a,t(C,()=>n(a)),C})()})),t(h,e(N,{withDivider:!0,get children(){return n("hideUnAvailableProxies")}}),D),O.addEventListener("change",a=>Ie(a.target.checked)),t(w,e(N,{withDivider:!0,get children(){return n("renderInTwoColumns")}}),A),K.addEventListener("change",a=>De(a.target.checked)),t(W,e(N,{withDivider:!0,get children(){return n("proxiesPreviewType")}}),j),j.addEventListener("change",a=>Me(a.target.value)),t(j,e(U,{get each(){return Object.values(Q)},children:a=>(()=>{var C=rt();return C.value=a,t(C,()=>n(a)),C})()})),t(X,e(N,{withDivider:!0,get children(){return n("iconHeight")}}),Y),Y.addEventListener("change",a=>ke(Number(a.target.value))),t(X,e(N,{withDivider:!0,get children(){return n("iconMarginRight")}}),B),B.addEventListener("change",a=>Oe(Number(a.target.value))),g(()=>u.checked=Ae()),g(()=>I.value=Be()),g(()=>k.value=Fe()),g(()=>T.value=Re()),g(()=>E.value=ne()),g(()=>O.checked=xe()),g(()=>K.checked=ie()),g(()=>j.value=Z()),g(()=>Y.value=$e()),g(()=>B.value=ye()),r}})},be=s=>{const n=()=>Z()===Q.OFF,r=$(()=>s.proxyNameList.length<=10),l=$(()=>{const u=Z();return u===Q.BAR||u===Q.Auto&&!r()}),o=$(()=>{const u=Z();return u===Q.DOTS||u===Q.Auto&&r()});return e(H,{get when(){return!n()},get children(){return e(He,{get children(){return[e(de,{get when(){return l()},get children(){return e(st,{get proxyNameList(){return s.proxyNameList},get now(){return s.now}})}}),e(de,{get when(){return o()},get children(){return e(ot,{get proxyNameList(){return s.proxyNameList},get now(){return s.now}})}})]}})}})};var it=v('<div class="flex items-center gap-2 py-2"><div class="my-1 flex flex-1 items-center justify-center overflow-hidden rounded-2xl [&amp;>*]:h-2"><div class=bg-success></div><div class=bg-warning></div><div class=bg-error></div><div class=bg-neutral>');const st=s=>{const{getLatencyByName:n}=le(),r=$(()=>s.proxyNameList.map(d=>n(d))),l=$(()=>r().length),o=$(()=>r().filter(d=>d>M().NOT_CONNECTED&&d<=M().MEDIUM).length),u=$(()=>r().filter(d=>d>M().MEDIUM&&d<=M().HIGH).length),b=$(()=>r().filter(d=>d>M().HIGH).length),I=$(()=>r().filter(d=>d===M().NOT_CONNECTED).length);return(()=>{var d=it(),k=d.firstChild,y=k.firstChild,T=y.nextSibling,L=T.nextSibling,E=L.nextSibling;return t(d,e(_e,{get name(){return s.now}}),null),g(h=>{var D=`${o()*100/l()}%`,O=`${u()*100/l()}%`,w=`${b()*100/l()}%`,A=`${I()*100/l()}%`;return D!==h.e&&((h.e=D)!=null?y.style.setProperty("width",D):y.style.removeProperty("width")),O!==h.t&&((h.t=O)!=null?T.style.setProperty("width",O):T.style.removeProperty("width")),w!==h.a&&((h.a=w)!=null?L.style.setProperty("width",w):L.style.removeProperty("width")),A!==h.o&&((h.o=A)!=null?E.style.setProperty("width",A):E.style.removeProperty("width")),h},{e:void 0,t:void 0,a:void 0,o:void 0}),d})()};var lt=v("<div>"),at=v('<div class="flex items-center gap-2 py-2"><div class="flex flex-1 flex-wrap items-center gap-1">');const ct=s=>{let n=s.selected?"bg-white border-4 border-success":"bg-success";return typeof s.latency!="number"||s.latency===M().NOT_CONNECTED?n=s.selected?"bg-white border-4 border-neutral":"bg-neutral":s.latency>M().HIGH?n=s.selected?"bg-white border-4 border-error":"bg-error":s.latency>M().MEDIUM&&(n=s.selected?"bg-white border-4 border-warning":"bg-warning"),(()=>{var r=lt();return g(l=>{var o=R("h-4 w-4 rounded-full",n),u=s.name;return o!==l.e&&G(r,l.e=o),u!==l.t&&we(r,"title",l.t=u),l},{e:void 0,t:void 0}),r})()},ot=s=>{const{getLatencyByName:n}=le();return(()=>{var r=at(),l=r.firstChild;return t(l,e(U,{get each(){return s.proxyNameList.map(o=>[o,n(o)])},children:([o,u])=>{const b=s.now===o;return e(ct,{name:o,latency:u,selected:b})}})),t(r,e(_e,{get name(){return s.now}}),null),r})()};var dt=v("<progress class=progress max=100>"),ut=v('<div class="text-sm text-slate-500"> / <!> ( <!>% )'),gt=v('<div class="text-sm text-slate-500">: ');const vt=s=>{const{Download:n=0,Upload:r=0,Total:l=0,Expire:o=0}=s,u=se(l,{units:"iec"}),b=se(n+r,{units:"iec"}),I=je.toFinite(((n+r)/l*100).toFixed(2));return{total:u,used:b,percentage:I,expirePrefix:()=>{const[y]=ee();return y("expire")},expireStr:()=>{const[y]=ee();return o===0?y("noExpire"):Ye(o*1e3).format("YYYY-MM-DD")}}},ht=s=>{if(!s.subscriptionInfo)return;const n=vt(s.subscriptionInfo);return[(()=>{var r=dt();return g(()=>r.value=n.percentage),r})(),(()=>{var r=ut(),l=r.firstChild,o=l.nextSibling,u=o.nextSibling,b=u.nextSibling;return b.nextSibling,t(r,()=>`${n.used}`,l),t(r,()=>`${n.total}`,o),t(r,()=>n.percentage,b),r})(),(()=>{var r=gt(),l=r.firstChild;return t(r,()=>n.expirePrefix(),l),t(r,()=>n.expireStr(),null),r})()]};var pe=v("<div>"),mt=v('<div class="flex h-full flex-col gap-2"><div class="flex items-center gap-2"><div class="tabs-boxed tabs gap-2"></div><div class=ml-auto></div></div><div class="flex-1 overflow-y-auto">'),ft=v('<button><span></span><div class="badge badge-sm">'),bt=v("<img>"),pt=v('<div class="flex items-center justify-between pr-8"><div class="flex items-center"><span></span><div class="badge badge-sm ml-2">'),xt=v('<div class="flex items-center justify-between text-sm text-slate-500"><span> </span><span>/s'),$t=v('<div class="flex items-center justify-between pr-8"><div class="flex items-center gap-2"><span></span><div class="badge badge-sm"></div></div><div class="flex items-center gap-2">'),yt=v('<div class="text-sm text-slate-500"> :: <!> ');const St=()=>{const s=ze();if(!Qe())return s("/setup",{replace:!0}),null;let n;const[r]=ee(),{fetchProxies:l,proxies:o,selectProxyInGroup:u,proxyProviders:b,updateProviderByProviderName:I,updateAllProvider:d,proxyGroupLatencyTest:k,proxyProviderLatencyTest:y,proxyGroupLatencyTestingMap:T,proxyProviderLatencyTestingMap:L,isAllProviderUpdating:E,updatingMap:h}=le(),D=$(()=>o().filter(p=>!p.hidden)),{speedGroupByName:O}=Ke(),[w,A]=We(ue({}),{name:"collapsedMap",storage:localStorage}),K=(p,P)=>{A(V=>({...V,[p]:P}))};Xe(l);const W=async(p,P)=>{p.stopPropagation(),k(P)},j=(p,P)=>{p.stopPropagation(),y(P)},X=(p,P)=>{p.stopPropagation(),I(P)},Y=async p=>{p.stopPropagation(),d()},[B,a]=ue("proxies"),C=()=>[{type:"proxies",name:r("proxies"),count:D().length},{type:"proxyProviders",name:r("proxyProviders"),count:b().length}];return[e(Ge,{get children(){return r("proxies")}}),(()=>{var p=mt(),P=p.firstChild,V=P.firstChild,ae=V.nextSibling,ce=P.nextSibling;return t(V,e(U,{get each(){return C()},children:m=>(()=>{var i=ft(),F=i.firstChild,q=F.nextSibling;return i.$$click=()=>a(m.type),t(F,()=>m.name),t(q,()=>m.count),g(()=>G(i,R(B()===m.type&&"tab-active","tab-sm sm:tab-md tab gap-2 px-2"))),i})()})),t(P,e(H,{get when(){return B()==="proxyProviders"},get children(){return e(J,{class:"btn btn-circle btn-sm",get disabled(){return E()},onClick:m=>Y(m),get icon(){return e(fe,{get class(){return R(E()&&"animate-spin text-success")}})}})}}),ae),t(ae,e(J,{class:"btn-circle btn-primary btn-sm",onClick:()=>n==null?void 0:n.showModal(),get icon(){return e(qe,{})}})),t(ce,e(H,{get when(){return B()==="proxies"},get children(){var m=pe();return t(m,e(U,{get each(){return D()},children:i=>{const F=$(()=>Je(ge(i.all??[],ne()),xe())),q=[(()=>{var c=pt(),_=c.firstChild,S=_.firstChild,z=S.nextSibling;return t(_,e(H,{get when(){return i.icon},get children(){var f=bt();return g(x=>{var oe=i.icon,te=`${$e()}px`,re=`${ye()}px`;return oe!==x.e&&we(f,"src",x.e=oe),te!==x.t&&((x.t=te)!=null?f.style.setProperty("height",te):f.style.removeProperty("height")),re!==x.a&&((x.a=re)!=null?f.style.setProperty("margin-right",re):f.style.removeProperty("margin-right")),x},{e:void 0,t:void 0,a:void 0}),f}}),S),t(S,()=>i.name),t(z,()=>{var f;return(f=i.all)==null?void 0:f.length}),t(c,e(J,{class:"btn-circle btn-sm",get disabled(){return T()[i.name]},onClick:f=>W(f,i.name),get icon(){return e(ve,{get class(){return R(T()[i.name]&&"animate-pulse text-success")}})}}),null),c})(),(()=>{var c=xt(),_=c.firstChild,S=_.firstChild,z=_.nextSibling,f=z.firstChild;return t(_,()=>i.type,S),t(_,()=>{var x;return((x=i.now)==null?void 0:x.length)>0&&` :: ${i.now}`},null),t(z,()=>se(O()[i.name]??0).toString(),f),c})(),e(H,{get when(){return!w()[i.name]},get children(){return e(be,{get proxyNameList(){return F()},get now(){return i.now}})}})];return e(he,{get isOpen(){return w()[i.name]},title:q,onCollapse:c=>K(i.name,c),get children(){return e(U,{get each(){return F()},children:c=>e(me,{proxyName:c,get isSelected(){return i.now===c},onClick:()=>void u(i,c)})})}})}})),g(()=>G(m,R("grid grid-cols-1 place-items-start gap-2",ie()?"sm:grid-cols-2":"sm:grid-cols-1"))),m}}),null),t(ce,e(H,{get when(){return B()==="proxyProviders"},get children(){var m=pe();return t(m,e(U,{get each(){return b()},children:i=>{const F=$(()=>ge(i.proxies.map(c=>c.name)??[],ne())),q=[(()=>{var c=$t(),_=c.firstChild,S=_.firstChild,z=S.nextSibling,f=_.nextSibling;return t(S,()=>i.name),t(z,()=>i.proxies.length),t(f,e(J,{class:"btn btn-circle btn-sm",get disabled(){return h()[i.name]},onClick:x=>X(x,i.name),get icon(){return e(fe,{get class(){return R(h()[i.name]&&"animate-spin text-success")}})}}),null),t(f,e(J,{class:"btn btn-circle btn-sm",get disabled(){return L()[i.name]},onClick:x=>j(x,i.name),get icon(){return e(ve,{get class(){return R(L()[i.name]&&"animate-pulse text-success")}})}}),null),c})(),e(ht,{get subscriptionInfo(){return i.subscriptionInfo}}),(()=>{var c=yt(),_=c.firstChild,S=_.nextSibling;return S.nextSibling,t(c,()=>i.vehicleType,_),t(c,()=>r("updated"),S),t(c,()=>Ze(i.updatedAt),null),c})(),e(H,{get when(){return!w()[i.name]},get children(){return e(be,{get proxyNameList(){return F()}})}})];return e(he,{get isOpen(){return w()[i.name]},title:q,onCollapse:c=>K(i.name,c),get children(){return e(U,{get each(){return F()},children:c=>e(me,{proxyName:c})})}})}})),g(()=>G(m,R("grid grid-cols-1 place-items-start gap-2",ie()?"sm:grid-cols-2":"sm:grid-cols-1"))),m}}),null),t(p,e(nt,{ref:m=>n=m}),null),p})()]};Ve(["click"]);export{St as default};
