import{N as O,u as oe,d as n,O as ke,S as De,i as r,P as ie,Q as Te,t as m,b as ze,y as Ge,A as F,R as Me,T as X,U as i,B as x,V as Y,I as J,W,H as D,X as R,Y as ee,Z as te,_ as Ee,r as Ke,w as Re,D as C,g as _,$ as I,a0 as w,a1 as ae,E as Ne,a2 as Oe,a3 as Ae,F as T,a4 as N,a5 as He,a6 as je,a7 as Ve,a8 as Ue,a9 as Le,aa as Ze,l as Qe}from"./index-BUuZZGdr.js";import{c as qe,g as Be,a as Xe,b as Ye,d as Je,e as We,I as et,f as tt,h as z,i as at,j as nt,r as lt}from"./index-DpEgW1uL.js";import{f as rt}from"./global-C7BdpSTv.js";import{D as st}from"./DocumentTitle-BsE74FyM.js";/**
 * @license @tabler/icons-solidjs v3.19.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ot=O("outline","info-small","IconInfoSmall",[["path",{d:"M12 9h.01"}],["path",{d:"M11 12h1v4h1"}]]);/**
 * @license @tabler/icons-solidjs v3.19.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var ne=O("filled","zoom-in-filled","IconZoomInFilled",[["path",{d:"M14 3.072a8 8 0 0 1 2.617 11.424l4.944 4.943a1.5 1.5 0 0 1 -2.008 2.225l-.114 -.103l-4.943 -4.944a8 8 0 0 1 -12.49 -6.332l-.006 -.285l.005 -.285a8 8 0 0 1 11.995 -6.643zm-4 2.928a1 1 0 0 0 -.993 .883l-.007 .117v2h-2l-.117 .007a1 1 0 0 0 0 1.986l.117 .007h2v2l.007 .117a1 1 0 0 0 1.986 0l.007 -.117v-2h2l.117 -.007a1 1 0 0 0 0 -1.986l-.117 -.007h-2v-2l-.007 -.117a1 1 0 0 0 -.993 -.883z"}]]);/**
 * @license @tabler/icons-solidjs v3.19.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var le=O("filled","zoom-out-filled","IconZoomOutFilled",[["path",{d:"M14 3.072a8 8 0 0 1 2.617 11.424l4.944 4.943a1.5 1.5 0 0 1 -2.008 2.225l-.114 -.103l-4.943 -4.944a8 8 0 0 1 -12.49 -6.332l-.006 -.285l.005 -.285a8 8 0 0 1 11.995 -6.643zm-1 5.928h-6l-.117 .007a1 1 0 0 0 0 1.986l.117 .007h6l.117 -.007a1 1 0 0 0 0 -1.986l-.117 -.007z"}]]),it=m("<pre><code>");const ct=d=>{const[b]=oe();return n(Te,{ref:g=>{var a;return(a=d.ref)==null?void 0:a.call(d,g)},get icon(){return n(ke,{size:24})},get title(){return b("connectionsDetails")},get children(){return n(De,{get when(){return d.selectedConnectionID},get children(){var g=it(),a=g.firstChild;return r(a,()=>JSON.stringify(ie().find(({id:$})=>$===d.selectedConnectionID),null,2)),g}})}})};var dt=async d=>{typeof d=="string"?await navigator.clipboard.writeText(d):await navigator.clipboard.write(d)},re=m('<div class="flex h-4 items-center">'),ut=m('<div class="flex h-full flex-col gap-2"><div class="flex w-full flex-wrap items-center gap-2"><div class="flex items-center gap-2"><div class="tabs-boxed tabs gap-2"></div><div class="flex items-center"><span class="mr-2 hidden lg:inline-block">:</span><input type=checkbox class=toggle></div><select class="select select-bordered select-primary select-sm w-full max-w-full flex-1"><option value=""></option></select></div><div class="join flex flex-1 items-center md:flex-1"><input type=search class="input input-sm join-item input-primary min-w-0 flex-1"></div></div><div class="overflow-x-auto whitespace-nowrap rounded-md bg-base-300"><table><thead class="sticky top-0 z-10 h-8"></thead><tbody>'),gt=m('<button><span></span><div class="badge badge-sm">'),mt=m("<option>"),pt=m("<tr>"),bt=m("<th class=bg-base-200><div><div>"),ft=m("<button class=cursor-pointer>"),ht=m('<tr class="hover:!bg-primary hover:text-primary-content">'),vt=m("<td class=py-2>"),Ct=m("<button><div></div><div></div><div>(<!>)");const se=(d,b,g,a)=>{const $=lt(d.getValue(b),g);return a({itemRank:$}),$.passed},yt=()=>{const d=ze();if(!Ge())return d("/setup",{replace:!0}),null;let b,g;const[a]=oe(),[$,ce]=F(0),{activeConnections:A,closedConnections:H,paused:de,setPaused:ue}=Me(),[ge,j]=F(""),[V,me]=X(F(!1),{name:"enableQuickFilter",storage:localStorage}),[pe,be]=F(),fe=[{header:()=>a("details"),enableGrouping:!1,enableSorting:!1,enableColumnFilter:!1,enableGlobalFilter:!1,accessorKey:i.Details,cell:({row:e})=>(()=>{var s=re();return r(s,n(x,{class:"btn-circle btn-xs",onClick:()=>{be(e.original.id),g==null||g.showModal()},get icon(){return n(ot,{size:"16"})}})),s})()},{header:()=>a("close"),enableGrouping:!1,enableSorting:!1,enableColumnFilter:!1,enableGlobalFilter:!1,accessorKey:i.Close,cell:({row:e})=>(()=>{var s=re();return r(s,n(x,{class:"btn-circle btn-xs",onClick:()=>Y(e.original.id),get icon(){return n(J,{size:"16"})}})),s})()},{header:()=>a("ID"),enableGrouping:!1,accessorKey:i.ID,accessorFn:e=>e.id},{header:()=>a("type"),accessorKey:i.Type,accessorFn:e=>`${e.metadata.type}(${e.metadata.network})`},{header:()=>a("process"),accessorKey:i.Process,accessorFn:e=>e.metadata.process||e.metadata.processPath.replace(/^.*[/\\](.*)$/,"$1")||"-"},{header:()=>a("host"),accessorKey:i.Host,accessorFn:e=>`${e.metadata.host?e.metadata.host:e.metadata.destinationIP}:${e.metadata.destinationPort}`},{header:()=>a("sniffHost"),accessorKey:i.SniffHost,accessorFn:e=>e.metadata.sniffHost||"-"},{header:()=>a("rules"),accessorKey:i.Rule,accessorFn:e=>e.rulePayload?`${e.rule} :: ${e.rulePayload}`:e.rule},{header:()=>a("chains"),accessorKey:i.Chains,accessorFn:e=>e.chains.slice().reverse().join(" :: ")},{header:()=>a("connectTime"),enableGrouping:!1,accessorKey:i.ConnectTime,accessorFn:e=>rt(e.start),sortingFn:(e,s)=>W(e.original.start).valueOf()-W(s.original.start).valueOf()},{header:()=>a("dlSpeed"),enableGrouping:!1,accessorKey:i.DlSpeed,accessorFn:e=>`${D(e.downloadSpeed)}/s`,sortingFn:(e,s)=>e.original.downloadSpeed-s.original.downloadSpeed},{header:()=>a("ulSpeed"),enableGrouping:!1,accessorKey:i.ULSpeed,accessorFn:e=>`${D(e.uploadSpeed)}/s`,sortingFn:(e,s)=>e.original.uploadSpeed-s.original.uploadSpeed},{header:()=>a("dl"),enableGrouping:!1,accessorKey:i.Download,accessorFn:e=>D(e.download),sortingFn:(e,s)=>e.original.download-s.original.download},{header:()=>a("ul"),enableGrouping:!1,accessorKey:i.Upload,accessorFn:e=>D(e.upload),sortingFn:(e,s)=>e.original.upload-s.original.upload},{header:()=>a("sourceIP"),accessorKey:i.SourceIP,accessorFn:e=>{const s=R().find(f=>f.sourceIP===e.metadata.sourceIP);return s?s.tagName:e.metadata.sourceIP}},{header:()=>a("sourcePort"),accessorKey:i.SourcePort,accessorFn:e=>e.metadata.sourcePort},{header:()=>a("destination"),accessorKey:i.Destination,accessorFn:e=>e.metadata.remoteDestination||e.metadata.destinationIP||e.metadata.host},{header:()=>a("inboundUser"),accessorKey:i.InboundUser,accessorFn:e=>e.metadata.inboundUser||e.metadata.inboundName||e.metadata.inboundPort}],[he,ve]=F([]),[Ce,$e]=X(F([{id:i.ConnectTime,desc:!0}]),{name:"connectionsTableSorting",storage:localStorage}),y=qe({filterFns:{fuzzy:se},state:{get columnOrder(){return ee()},get grouping(){return he()},get sorting(){return Ce()},get columnVisibility(){return te()},get globalFilter(){return ge()}},get data(){const e=$()===0?A():H();if(e.sort((f,P)=>f.id.localeCompare(P.id)),!V())return e;const s=new RegExp(Ee(),"i");return e.filter(f=>!s.test(f.chains.join("")))},sortDescFirst:!0,enableHiding:!0,columns:fe,onGlobalFilterChange:j,globalFilterFn:se,onGroupingChange:ve,onSortingChange:$e,getFilteredRowModel:Be(),getSortedRowModel:Xe(),getExpandedRowModel:Ye(),getGroupedRowModel:Je(),getCoreRowModel:We()}),G=y.getFlatHeaders().find(({id:e})=>e===i.SourceIP),[M,Se]=F("");Ke(Re(M,()=>{const e=R().find(s=>s.sourceIP===M());G==null||G.column.setFilterValue(e?e.tagName:M())}));const Fe=C(()=>[{type:0,name:a("active"),count:A().length},{type:1,name:a("closed"),count:H().length}]);return[n(st,{get children(){return a("connections")}}),(()=>{var e=ut(),s=e.firstChild,f=s.firstChild,P=f.firstChild,U=P.nextSibling,E=U.firstChild,_e=E.firstChild,L=E.nextSibling,K=U.nextSibling,ye=K.firstChild,k=f.nextSibling,Z=k.firstChild,xe=s.nextSibling,Q=xe.firstChild,q=Q.firstChild,Ie=q.nextSibling;return r(P,n(ae,{get each(){return Fe()},children:t=>(()=>{var o=gt(),l=o.firstChild,h=l.nextSibling;return o.$$click=()=>ce(t().type),r(l,()=>t().name),r(h,()=>t().count),_(()=>I(o,w($()===t().type&&"tab-active","tab-sm sm:tab-md tab gap-2 px-2"))),o})()})),r(E,()=>a("quickFilter"),_e),L.addEventListener("change",t=>me(t.target.checked)),K.addEventListener("change",t=>Se(t.target.value)),r(ye,()=>a("all")),r(K,n(ae,{get each(){return Ne.uniq(ie().map(({metadata:{sourceIP:t}})=>{const o=R().find(l=>l.sourceIP===t);return o?o.tagName:t})).sort()},children:t=>(()=>{var o=mt();return r(o,t),_(()=>o.value=t()),o})()}),null),Z.$$input=t=>j(t.target.value),r(k,n(x,{class:"btn btn-primary join-item btn-sm",onClick:()=>ue(t=>!t),get icon(){return C(()=>!!de())()?n(et,{}):n(tt,{})}}),null),r(k,n(x,{class:"btn btn-primary join-item btn-sm",onClick:()=>{y.getState().globalFilter?y.getFilteredRowModel().rows.forEach(({original:t})=>Y(t.id)):Oe()},get icon(){return n(J,{})}}),null),r(k,n(x,{class:"btn btn-primary join-item btn-sm",onClick:()=>b==null?void 0:b.showModal(),get icon(){return n(Ae,{})}}),null),r(q,n(T,{get each(){return y.getHeaderGroups()},children:t=>(()=>{var o=pt();return r(o,n(T,{get each(){return t.headers},children:l=>(()=>{var h=bt(),v=h.firstChild,c=v.firstChild;return r(v,(()=>{var u=C(()=>!!l.column.getCanGroup());return()=>u()?(()=>{var p=ft();return N(p,"click",l.column.getToggleGroupingHandler(),!0),r(p,(()=>{var S=C(()=>!!l.column.getIsGrouped());return()=>S()?n(le,{size:18}):n(ne,{size:18})})()),p})():null})(),c),N(c,"click",l.column.getToggleSortingHandler(),!0),r(c,()=>z(l.column.columnDef.header,l.getContext())),r(v,()=>({asc:n(at,{}),desc:n(nt,{})})[l.column.getIsSorted()]??null,null),_(u=>{var p=w("flex items-center gap-2"),S=w(l.column.getCanSort()&&"cursor-pointer select-none","flex-1");return p!==u.e&&I(v,u.e=p),S!==u.t&&I(c,u.t=S),u},{e:void 0,t:void 0}),h})()})),o})()})),r(Ie,n(T,{get each(){return y.getRowModel().rows},children:t=>(()=>{var o=ht();return r(o,n(T,{get each(){return t.getVisibleCells()},children:l=>(()=>{var h=vt();return h.$$contextmenu=v=>{v.preventDefault();const c=l.renderValue();c&&dt(c).catch(()=>{})},r(h,(()=>{var v=C(()=>!!l.getIsGrouped());return()=>v()?(()=>{var c=Ct(),u=c.firstChild,p=u.nextSibling,S=p.nextSibling,we=S.firstChild,B=we.nextSibling;return B.nextSibling,N(c,"click",t.getToggleExpandedHandler(),!0),r(u,(()=>{var Pe=C(()=>!!t.getIsExpanded());return()=>Pe()?n(le,{size:18}):n(ne,{size:18})})()),r(p,()=>z(l.column.columnDef.cell,l.getContext())),r(S,()=>t.subRows.length,B),_(()=>I(c,w(t.getCanExpand()?"cursor-pointer":"cursor-normal","flex items-center gap-2"))),c})():(()=>{var c=C(()=>!!l.getIsAggregated());return()=>c()?z(l.column.columnDef.aggregatedCell??l.column.columnDef.cell,l.getContext()):(()=>{var u=C(()=>!!l.getIsPlaceholder());return()=>u()?null:z(l.column.columnDef.cell,l.getContext())})()})()})()),h})()})),o})()})),r(e,n(Ve,{ref:t=>b=t,get order(){return ee()},get visible(){return te()},onOrderChange:t=>He(t),onVisibleChange:t=>je({...t})}),null),r(e,n(ct,{ref:t=>g=t,get selectedConnectionID(){return pe()}}),null),_(t=>{var o=a("search"),l=w(Ue(Le()),"table table-zebra relative rounded-none");return o!==t.e&&Ze(Z,"placeholder",t.e=o),l!==t.t&&I(Q,t.t=l),t},{e:void 0,t:void 0}),_(()=>L.checked=V()),e})()]};Qe(["input","click","contextmenu"]);export{yt as default};
